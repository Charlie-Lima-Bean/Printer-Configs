[gcode_macro _UNLOAD_FIL]
gcode:
    {% set TEMP = params.TEMP|int %}
    M109 S{TEMP}
    M83
    G1 E-49 F300
    G1 E-49 F300
    TURN_OFF_HEATERS

[gcode_macro UNLOAD_PLA]
gcode:
    _UNLOAD_FIL TEMP=240

[gcode_macro UNLOAD_ABS]
gcode:
    _UNLOAD_FIL TEMP=260

[gcode_macro _LOAD_FIL]
gcode:
    {% set TEMP = params.TEMP|int %}
    HOME_IF_NEEDED
    clean_nozzle
    M109 S{TEMP} ; wait for hotend temp
    M83
    G1 E49 F300
    G1 E31 F300 ; total 80
    clean_nozzle
    TURN_OFF_HEATERS

[gcode_macro LOAD_PLA]
gcode:
    _LOAD_FIL TEMP=240

[gcode_macro LOAD_ABS]
gcode:
    _LOAD_FIL TEMP=260